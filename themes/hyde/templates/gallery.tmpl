<%doc>
Template used for image galleries.

If ``folders`` contains items then this is a listing of galleries or is a gallery
which contains sub-galleries.

Interesting variables include:

* post: A post object, containing descriptive post.text() for the gallery.
* crumbs: A list of link, crumb to implement breadcrumbs.
* folders: A list of folders to implement hierarchical gallery navigation.
* enable_comments: To enable/disable comments in galleries.
* thumbnail_size: The THUMBNAIL_SIZE option.
* photo_array: a list of dictionaries, each containing:

    * url: URL for the full-sized image.
    * url_thumb: URL for the thumbnail.
    * title: The title of the image.
    * size: A dict containing w and h, the real size of the thumbnail.

</%doc>

<%inherit file="/base.tmpl"/>
<%block name="page_title">
  ## galleries is the default title for the listing of galleries
  % if title != 'galleries':
    ${title}
  % elif folders:
    Photo Galleries
  % endif
</%block>

% if post:
  <article class="post_body">
    <div>
      ${post.text()}
    </div>
  </article>
% endif


% if folders:
  <article class="post-group_body">

    % if photo_array:
      ## This gallery contains sub-galleries.
      <h3>Sub-Galleries:</h3>
    % endif

    <ul class="post-list">
      % for link, text in folders:
        <li class="">
          <h3 class="post-list_title">
            <a class="" href="${link}">${text|h}</a>
          </h3>
        </li>
      % endfor
    </ul>
  </article>
% endif


<article class="gallery_body">
  <div class="gallery_container">
    % if photo_array:
      % for image in photo_array:
        <%
          link = image['url']
          title = image['title']
          thumb_link = image['url_thumb']
          # Add the narrow class to figures in portrait
          extra_class = 'gallery_figure--narrow' if image['size']['h'] > image['size']['w'] else ''
        %>

        <figure class="gallery_figure ${extra_class}">
          <a href="${link}" class="gallery_link image-reference" title="${title}">
            <img class="gallery_image" src="${thumb_link}" alt="${title}" title="${title}"/>
          </a>
        </figure>

      % endfor
    % endif
  </div>

</article>
